<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>kspaceFirstOrder3D-OMP: Parameters/CommandLineParameters.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="header_bg.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">kspaceFirstOrder3D-OMP
   &#160;<span id="projectnumber">1.1</span>
   </div>
   <div id="projectbrief">The C++ implementation of the k-wave toolbox for the time-domain simulation of acoustic wave fields in 3D</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_command_line_parameters_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">CommandLineParameters.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The header file containing the command line parameters.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;cstdlib&gt;</code><br/>
<code>#include &lt;string&gt;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for CommandLineParameters.h:</div>
<div class="dyncontent">
<div class="center"><img src="_command_line_parameters_8h__incl.png" border="0" usemap="#_parameters_2_command_line_parameters_8h" alt=""/></div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="_command_line_parameters_8h__dep__incl.png" border="0" usemap="#_parameters_2_command_line_parameters_8hdep" alt=""/></div>
<map name="_parameters_2_command_line_parameters_8hdep" id="_parameters_2_command_line_parameters_8hdep">
<area shape="rect" id="node2" href="_parameters_8h.html" title="The header file containing the parameters of the simulation. " alt="" coords="507,81,668,106"/><area shape="rect" id="node11" href="_command_line_parameters_8cpp.html" title="The implementation file containing the command line parameters. " alt="" coords="693,81,947,106"/><area shape="rect" id="node3" href="_k_space_first_order3_d_solver_8h.html" title="The header file containing the main class of the project responsible for the entire simulation..." alt="" coords="29,155,197,194"/><area shape="rect" id="node6" href="_h_d_f5___file_8cpp.html" title="The implementation file containing the HDF5 related classes. " alt="" coords="223,162,361,187"/><area shape="rect" id="node7" href="_f_f_t_w_complex_matrix_8cpp.html" title="The implementation file containing the class that implements 3D FFT using the FFTW interface..." alt="" coords="386,155,568,194"/><area shape="rect" id="node8" href="_matrix_container_8cpp.html" title="The implementation file containing the matrix container. " alt="" coords="593,162,804,187"/><area shape="rect" id="node9" href="_output_h_d_f5_stream_8cpp.html" title="The implementation file of classes responsible for storing output quantities into the output HDF5 fil..." alt="" coords="829,155,1000,194"/><area shape="rect" id="node10" href="_parameters_8cpp.html" title="The implementation file containing parameters of the simulation. " alt="" coords="1025,162,1199,187"/><area shape="rect" id="node4" href="main_8cpp.html" title="The main file of kspaceFirstOrder3D&#45;OMP. " alt="" coords="5,250,77,275"/><area shape="rect" id="node5" href="_k_space_first_order3_d_solver_8cpp.html" title="The implementation file containing the main class of the project responsible for the entire simulatio..." alt="" coords="102,243,271,282"/></map>
</div>
</div>
<p><a href="_command_line_parameters_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_t_command_line_parameters.html">TCommandLineParameters</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The class to parse and store command line parameters.  <a href="class_t_command_line_parameters.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Jiri Jaros <br/>
 Faculty of Information Technology<br/>
 Brno University of Technology <br/>
 <a href="#" onclick="location.href='mai'+'lto:'+'jar'+'os'+'jir'+'@f'+'it.'+'vu'+'tbr'+'.c'+'z'; return false;">jaros<span style="display: none;">.nosp@m.</span>jir@<span style="display: none;">.nosp@m.</span>fit.v<span style="display: none;">.nosp@m.</span>utbr<span style="display: none;">.nosp@m.</span>.cz</a></dd></dl>
<dl class="section version"><dt>Version</dt><dd>kspaceFirstOrder3D 2.15</dd></dl>
<dl class="section date"><dt>Date</dt><dd>29 August 2012, 11:25 (created) <br/>
 02 October 2014, 12:15 (revised)</dd></dl>
<h1><a class="anchor" id="Params"></a>
Command Line Parameters</h1>
<p>The C++ code requires two mandatory parameters and accepts a few optional parameters and flags. The mandatory parameters <code>-i</code> and <code>-o</code> specify the input and output file. The file names respect the path conventions for particular operating system. If any of the files is not specified, cannot be found or created, an error message is shown.</p>
<p>The <code>-t</code> parameter sets the number of threads used, which defaults the system maximum. On CPUs with Intel Hyper-Threading (HT), the performance is sometimes better if HT is disabled in the BIOS settings. If HT is switched on, the default will be to spawn twice as many threads as there are physical processor cores, which may but again may not slow down the code execution. Therefore, if the HT is on, try specifying the number of threads manually for best performance (e.g. 4 for Intel i7). We recommend experimenting with this parameter to find the best configuration. Note, if there are other tasks being executed on the system, it might be useful to further limit the number of threads to prevent system overload.</p>
<p>The <code>-r</code> parameter specifies how often information about the simulation progress is printed out to the command line. By default, the C++ code prints out the progress of the simulation, the elapsed time, and the estimated time of completion in intervals corresponding to 5% of the total number of times steps.</p>
<p>The <code>-c</code> parameter specifies the compression level used by the ZIP library to reduce the size of the output file. The actual compression rate is highly dependent on the shape of the sensor mask and the range of stored quantities. In general, the output data is very hard to compress, and using higher compression levels can greatly increase the time to save data while not having a large impact on the final file size. That's why we decided to disable compression in default settings.</p>
<p>The <code><code>&ndash;benchmark</code></code> parameter enables the total length of simulation (i.e., the number of time steps) to be overridden by setting a new number of time steps to simulate. This is particularly useful for performance evaluation and benchmarking. As the code performance is relatively stable, 50-100 time steps is usually enough to predict the simulation duration. This parameter can also be used to quickly find the ideal number of CPU threads to use.</p>
<p>For jobs that are expected to run for a very long time, it may be useful to checkpoint and restart the execution. One motivation is the wall clock limit per task on clusters where jobs must fit within a given time span (e.g. 24 hours). The second motivation is a level of fault-tolerance, where you can back up the state of the simulation after a predefined period. To enable checkpoint-restart, the user is asked to specify a file to store the actual state of the simulation by <code>&ndash;checkpoint_file</code> and the period in seconds after which the simulation will be interrupted by <code>&ndash;checkpoint_interval</code>. When running on a cluster, please allocate enough time for the checkpoint procedure that can take a non-negligible amount of time (7 matrices have to be stored in the checkpoint file and all aggregated quantities are flushed into the output file).</p>
<p>When controlling a multi-leg simulation by a script loop, the parameters of the code remains the same in all legs. The first leg of the simulation creates a checkpoint file while the last one deletes it. If the checkpoint file is not found the simulation starts from the beginning. In order to find out how many steps have been finished, please open the output file and read the variable <code>t_index</code>.</p>
<p>The <code>-h</code> and <code>&ndash;help</code> parameters print all the parameters of the C++ code. The <code> &ndash;version </code>parameter reports detail information about the code useful for debugging and bug reports. It prints out the internal version, the build date and time, the git hash allowing us to track the version of the source code, the operating system, the compiler name and version and the instruction set used.</p>
<p>The remaining flags specify the output quantities to be recorded during the simulation and stored on disk analogous to the sensor.record input. If the <code>-p</code> or <code>&ndash;p_raw</code> flags are set (these are equivalent), a time series of the acoustic pressure at the grid points specified by the sensor mask is recorded. If the <code>&ndash;p_rms</code>, <code>&ndash;p_max</code>, <code>&ndash;p_min</code> flags are set, the root mean square and/or maximum and/or minimum values of the pressure at the grid points specified by the sensor mask are recorded. If the <code>&ndash;p_final</code> flag is set, the values for the entire acoustic pressure field in the final time step of the simulation is stored (this will always include the PML, regardless of the setting for <code> `PMLInside'</code>). The flags <code>&ndash;p_max_all</code> and <code>&ndash;p_min_all</code> allow to calculate the maximum and minimum values over the entire acoustic pressure field, regardless on the shape of the sensor mask. Flags to record the acoustic particle velocity are defined in an analogous fashion. For proper calculation of acoustic intensity, the particle velocity has to be shifted onto the same grid as the acoustic pressure. This can be done by setting <code>&ndash;u_non_staggered_raw</code> flag, that first shifts the particle velocity and then samples the grid points specified by the sensor mask. Since the shift operation requires additional FFTs, the impact on the simulation time may be significant.</p>
<p>Any combination of <code>p</code> and <code>u</code> flags is admissible. If no output flag is set, a time-series for the acoustic pressure is recorded. If it is not necessary to collect the output quantities over the entire simulation, the starting time step when the collection begins can be specified using the -s parameter. Note, the index for the first time step is 1 (this follows the MATLAB indexing convention).</p>
<p>The <code>&ndash;copy_sensor_mask</code> will copy the sensor from the input file to the output one at the end of the simulation. This helps in post-processing and visualisation of the outputs.</p>
<pre class="fragment">---------------------------------- Usage ---------------------------------
Mandatory parameters:
  -i &lt;input_file_name&gt;            : HDF5 input file
  -o &lt;output_file_name&gt;           : HDF5 output file

Optional parameters:
  -t &lt;num_threads&gt;                : Number of CPU threads
                                      (default = 4)
  -r &lt;interval_in_%&gt;              : Progress print interval
                                      (default = 5%)
  -c &lt;comp_level&gt;                 : Output file compression level &lt;0,9&gt;
                                      (default = 0)
  --benchmark &lt;steps&gt;             : Run a specified number of time steps

  --checkpoint_file &lt;file_name&gt;   : HDF5 checkpoint file
  --checkpoint_interval &lt;seconds&gt; : Stop after a given number of seconds and
                                      store the actual state

  -h                              : Print help
  --help                          : Print help
  --version                       : Print version

Output flags:
  -p                              : Store acoustic pressure
                                      (default if nothing else is on)
                                      (the same as --p_raw)
  --p_raw                         : Store raw time series of p (default)
  --p_rms                         : Store rms of p
  --p_max                         : Store max of p
  --p_min                         : Store min of p
  --p_max_all                     : Store max of p (whole domain)
  --p_min_all                     : Store min of p (whole domain)
  --p_final                       : Store final pressure field

  -u                              : Store ux, uy, uz
                                      (the same as --u_raw)
  --u_raw                         : Store raw time series of ux, uy, uz
  --u_non_staggered_raw           : Store non-staggered raw time series of
                                      ux, uy, uz
  --u_rms                         : Store rms of ux, uy, uz
  --u_max                         : Store max of ux, uy, uz
  --u_min                         : Store min of ux, uy, uz
  --u_max_all                     : Store max of ux, uy, uz (whole domain)
  --u_min_all                     : Store min of ux, uy, uz (whole domain)
  --u_final                       : Store final acoustic velocity

  --copy_sensor_mask              : Copy sensor mask to the output file

  -s &lt;timestep&gt;                   : Time step when data collection begins
                                      (default = 1)
--------------------------------------------------------------------------
</pre><h1><a class="anchor" id="License"></a>
License</h1>
<p>This file is part of the C++ extension of the k-Wave Toolbox (<a href="http://www.k-wave.org">http://www.k-wave.org</a>).<br/>
 Copyright (C) 2014 Jiri Jaros and Bradley Treeby</p>
<p>This file is part of k-Wave. k-Wave is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.</p>
<p>k-Wave is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.</p>
<p>You should have received a copy of the GNU Lesser General Public License along with k-Wave. If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>. </p>

<p>Definition in file <a class="el" href="_command_line_parameters_8h_source.html">CommandLineParameters.h</a>.</p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_e05d56c3c81e8a80e8e7fed7226c4d57.html">Parameters</a></li><li class="navelem"><a class="el" href="_command_line_parameters_8h.html">CommandLineParameters.h</a></li>
    <li class="footer">Generated on Thu Oct 2 2014 12:58:14 for kspaceFirstOrder3D-OMP by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
